# 功能規格：智慧選卡器

**功能分支**: `001-smart-card-selector`
**建立日期**: 2026-01-15
**狀態**: 草稿
**輸入**: 使用者描述: "我想做一個聰明選卡器的網頁，當使用者貼上他要結帳的東西的網頁之後，第一可以去爬這個商品是否為市面上最便宜的，有沒有其他平台更便宜（放上聯盟網址）；第二去爬購買當前的優惠用哪一張信用卡最划算，顯示其價格以及辦卡連結（放上聯盟網址），藉由聯盟行銷作為商業模式"

## 使用者場景與測試 *(必要)*

### 使用者故事 1 - 比價與推薦最佳購買平台 (優先級: P1)

使用者想要購買某個商品，希望找到最便宜的購買平台。使用者將商品頁面網址貼到智慧選卡器，系統會搜尋各大電商平台的價格，並顯示最便宜的選項，每個選項都附帶聯盟行銷連結。

**為什麼是這個優先級**: 這是核心價值所在，幫助使用者省錢，同時也是聯盟行銷收入的第一來源。沒有比價功能，整個產品就失去意義。

**獨立測試**: 使用者貼上任何主流電商（如蝦皮、momo、PChome）的商品連結，系統能顯示至少 3 個平台的價格比較結果，並標示最便宜的選項。

**驗收場景**:

1. **Given** 使用者在首頁看到輸入框，**When** 貼上一個有效的商品網址並送出，**Then** 系統顯示該商品在不同平台的價格比較（至少 3 個平台）
2. **Given** 系統已顯示價格比較結果，**When** 使用者查看結果，**Then** 最便宜的選項會被明確標示（如顏色標記或「最划算」標籤）
3. **Given** 系統顯示價格比較結果，**When** 使用者點擊任一平台連結，**Then** 瀏覽器開啟該平台的商品頁面（含聯盟追蹤參數）

---

### 使用者故事 2 - 信用卡優惠推薦 (優先級: P2)

使用者已經決定在某個平台購買商品，想知道用哪張信用卡最划算。系統會根據使用者選定的平台和商品價格，推薦最優惠的信用卡，顯示可省下的金額，並提供辦卡聯盟連結。

**為什麼是這個優先級**: 在使用者完成比價後，進一步提供信用卡優惠建議，增加使用者的省錢額度，同時創造第二層聯盟收入（信用卡推薦）。這是比價之後自然的延伸服務。

**獨立測試**: 使用者選擇某個購買平台後，系統顯示至少 3 張信用卡的優惠比較，包含現金回饋金額或折扣，並提供辦卡連結。

**驗收場景**:

1. **Given** 使用者已看到價格比較結果，**When** 點擊「查看信用卡優惠」或選擇某個平台，**Then** 系統顯示適用該平台的信用卡優惠清單（至少 3 張卡片）
2. **Given** 系統顯示信用卡優惠清單，**When** 使用者查看，**Then** 每張卡片都顯示具體優惠內容（如「回饋 5%，省 $150」）和辦卡連結
3. **Given** 使用者查看信用卡優惠，**When** 點擊辦卡連結，**Then** 瀏覽器開啟該信用卡的申請頁面（含聯盟追蹤參數）

---

### 使用者故事 3 - 綜合最划算方案顯示 (優先級: P3)

使用者希望一次看到「在哪個平台用哪張卡」的最優組合。系統會計算所有平台與信用卡組合，直接顯示「最終實付金額」最低的方案。

**為什麼是這個優先級**: 這是進階功能，讓使用者不需要自己比較「平台價格 + 信用卡優惠」，系統直接給出答案。提升使用者體驗，但在 MVP 階段可以先讓使用者自己對照。

**獨立測試**: 使用者查看結果時，在頁面頂部看到「最佳組合」區塊，顯示最終實付價格最低的「平台 + 信用卡」方案。

**驗收場景**:

1. **Given** 系統已完成價格與信用卡優惠查詢，**When** 使用者查看結果頁面，**Then** 頁面頂部顯示「最佳組合」區塊，包含平台名稱、信用卡名稱、原價、優惠、最終價格
2. **Given** 使用者看到最佳組合，**When** 點擊該組合的購買連結，**Then** 瀏覽器開啟對應平台的商品頁面
3. **Given** 使用者看到最佳組合，**When** 點擊該組合的辦卡連結，**Then** 瀏覽器開啟對應信用卡的申請頁面

---

### 邊界情況

- 當商品網址無法辨識或解析失敗時，系統該如何處理？
- 當某個商品在其他平台找不到相同商品時，系統如何顯示？
- 當沒有任何信用卡優惠適用於該平台時，系統該顯示什麼訊息？
- 當聯盟連結暫時失效或無法產生時，系統是否還顯示該選項？
- 當使用者貼上非支援平台的網址時，系統如何回應？

## 需求 *(必要)*

### 功能需求

- **FR-001**: 系統必須能辨識主流電商平台的商品網址（包含蝦皮、momo、PChome、Yahoo 購物中心、博客來等）
- **FR-002**: 系統必須能從商品網址提取商品名稱和基本資訊
- **FR-003**: 系統必須能搜尋至少 3 個電商平台上相同或類似商品的價格
- **FR-004**: 系統必須能在價格比較結果中附加聯盟行銷追蹤參數
- **FR-005**: 系統必須能辨識使用者選定的購買平台
- **FR-006**: 系統必須能提供至少 3 張信用卡的優惠資訊（針對該平台）
- **FR-007**: 系統必須計算並顯示使用特定信用卡後的實際優惠金額
- **FR-008**: 系統必須在信用卡推薦中附加辦卡聯盟連結
- **FR-009**: 系統必須能計算「平台價格 + 信用卡優惠」的最終實付金額
- **FR-010**: 系統必須將比價和信用卡優惠資料持久化儲存，以供後續分析和優化

### 關鍵實體 *(包含資料的功能適用)*

- **商品**: 代表使用者想購買的商品，包含名稱、原始網址、商品類別
- **平台價格**: 代表某個電商平台上該商品的售價，包含平台名稱、價格、可用性、聯盟連結
- **信用卡優惠**: 代表某張信用卡在特定平台的優惠資訊，包含卡片名稱、優惠類型（現金回饋/折扣）、優惠金額或百分比、適用條件、辦卡連結
- **最佳方案**: 代表經過計算後的最優「平台 + 信用卡」組合，包含平台名稱、信用卡名稱、最終實付價格

## 成功標準 *(必要)*

### 可衡量成果

- **SC-001**: 使用者在貼上商品網址後，系統能在 10 秒內顯示至少 3 個平台的價格比較結果
- **SC-002**: 系統對於主流電商（蝦皮、momo、PChome）的商品網址辨識成功率達 95% 以上
- **SC-003**: 使用者能在 3 次點擊內完成從貼上網址到看到最佳方案的完整流程
- **SC-004**: 至少 70% 的使用者會點擊平台或信用卡的聯盟連結（透過點擊率追蹤）
- **SC-005**: 系統能同時支援 100 名使用者同時查詢而不明顯延遲（每個查詢在 10 秒內完成）

## 假設

- 主流電商平台的網頁結構在短期內不會劇烈變動，或系統能即時適應變化
- 聯盟行銷平台提供的 API 或連結格式穩定可用
- 信用卡優惠資訊能透過公開資訊或合作方式取得
- 使用者願意等待數秒以獲得完整的比價和推薦結果
- 系統能合法爬取電商平台的公開商品資訊（符合各平台的使用條款）

## 範圍界定

### 包含在此功能中

- 商品網址的辨識與解析
- 多平台價格比較
- 信用卡優惠查詢與推薦
- 聯盟行銷連結生成與追蹤
- 最佳方案計算與顯示
- 基本的錯誤處理和使用者提示

### 不包含在此功能中

- 使用者帳號系統和登入功能（MVP 階段不需要）
- 商品價格歷史追蹤或價格變動通知
- 使用者自訂追蹤清單或願望清單
- 行動應用程式（僅限網頁版）
- 即時庫存查詢（僅顯示價格）
- 完整的購物車整合或代購服務
